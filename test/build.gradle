import com.moowork.gradle.node.task.NodeTask

node {
  version = "${nodeVersion}"
  download = true
  distBaseUrl = "https://nodejs.org/dist/"
  nodeModulesDir = file("${project.projectDir}")
  workDir = file("${rootProject.projectDir}/.gradle/nodejs")
  npmWorkDir = file("${rootProject.projectDir}/.gradle/npm")
}

clean {
  delete "build/test-results"
}

tasks.register("cypressTest", NodeTask) {
  dependsOn "npmInstall"

  def baseUrl = System.getProperty("baseUrl", "http://localhost:8070")
  script = file("scripts/run.js")
  args = ["baseUrl=$baseUrl"]
}
